#!/bin/bash

export PATH=/opt/xcalar/bin:$PATH

if [ -n "$XLRDIR" ]; then
    export PATH="$XLRDIR"/bin:$PATH
fi

declare -a CGROUPS_V1_CONTROLLERS=("memory")

MIN_TOTAL_MEM="${XCE_JUPYTER_MIN_TOTAL_MEM:-$XCE_MW_MIN_TOTAL_MEM}"
SOFT_MEM_PCT="${XCE_JUPYTER_SOFT_MEM_PCT:-$XCE_MW_SOFT_MEM_PCT}"
MEM_PCT="${XCE_JUPYTER_MEM_PCT:-$XCE_MW_MEM_PCT}"
SVC_CNT="${XCE_JUPYTER_SVC_CNT:-$XCE_MW_SVC_CNT}"
SWAPPINESS="${XCE_JUPYTER_SWAPPINESS:-$XCE_MW_SWAPPINESS}"
OOM_CONTROL="${XCE_JUPYTER_OOM_CONTROL:-$XCE_MW_OOM_CONTROL}"
SYSD_UNIT_NAME="${XCE_JUPYTER_UNIT}"

. cgroupMgmtUtils.sh

PYTHONUSERBASE="${XCE_USER_HOME}/.local"
HOME="$XCE_HOME"

export HOME PYTHONUSERBASE

cgroupMode
cgroupMwSetup

exec python3.6 ${XLRDIR}/bin/jupyter-notebook
